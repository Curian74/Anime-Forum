@model WibuBlog.ViewModels.Ticket.AddTicketVM

<div class="container mt-4 p-4 border rounded shadow-sm bg-light" style="max-width: 600px;">
    <h2 class="mb-3 text-center">Create supported ticket</h2>
    <form asp-action="Add" asp-controller="Ticket" method="post" id="ticketForm">
        @if (TempData["SuccessMessage"] != null)
        {
            <div class="alert alert-success" role="alert">
                @TempData["SuccessMessage"]
            </div>
        }
        @if (TempData["ErrorMessage"] != null)
        {
            <div class="alert alert-danger" role="alert">
                @TempData["ErrorMessage"]
            </div>
        }
        <label asp-for="Email" class="fw-bold mt-3">Email</label>
        <input asp-for="Email" class="form-control" placeholder="Enter your email">
        <span class="text-danger" asp-validation-for="Email"></span>

        <label asp-for="Content" class="fw-bold">Content</label>
        <div id="editor-container" class="border rounded p-2 bg-white" style="height: 200px;"></div>
        <input type="hidden" asp-for="Content" id="content-input">
        <span class="text-danger" asp-validation-for="Content"></span>

        <label asp-for="Tag" class="fw-bold mt-3">Select Tag</label>
        <select asp-for="Tag" class="form-select">
            <option value="#BannedAccount">🔒 Banned Account</option>
            <option value="#HelpCreatePost">✍️ Help Create Post</option>
            <option value="#TechnicalIssue">⚙️ Technical Issue</option>
        </select>


        <button type="button" id="submitBtn" class="btn btn-primary w-100 mt-4">🚀 Submit Ticket</button>
    </form>
</div>

<link href="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.snow.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.min.js"></script>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        var quill = new Quill('#editor-container', {
            theme: 'snow',
            placeholder: 'Describe your issue...',
            modules: { toolbar: [['bold', 'italic', 'underline'], [{ 'list': 'ordered' }, { 'list': 'bullet' }], ['image']] }
        });

        quill.on('text-change', function() {
            document.querySelector('#content-input').value = quill.root.innerHTML;
        });

        document.querySelector('#submitBtn').addEventListener('click', function() {
            if (quill.getText().trim() === '') {
                alert('Content is required');
                return;
            }
            document.querySelector('#ticketForm').submit();
        });
    });
</script>
